{
   "entities": {
      "startup": {
         "type": "system",
         "uid": "00001",
         "tag": "system",
         "id": "startup",
         "displayName": "Startup",
         "attrs": {},
         "flags": {
            "this": false,
            "that": false
         },
         "body": [
            {
               "type": "macro",
               "uid": "00001.00012",
               "tag": "settings",
               "body": [
                  {
                     "type": "macro",
                     "uid": "00001.00013",
                     "tag": "start",
                     "id": "stately library"
                  },
                  {
                     "type": "macro",
                     "uid": "00001.00014",
                     "tag": "tsp_version",
                     "inlineText": "1.1.1"
                  },
                  {
                     "type": "macro",
                     "uid": "00001.00015",
                     "tag": "app_version",
                     "inlineText": "1.0.0"
                  },
                  {
                     "type": "macro",
                     "uid": "00001.00016",
                     "tag": "author",
                     "inlineText": "Pete Gardner"
                  },
                  {
                     "type": "macro",
                     "uid": "00001.00017",
                     "tag": "title",
                     "body": [
                        {
                           "type": "text",
                           "uid": "00018",
                           "tag": "text",
                           "body": "Tsp Game Demo"
                        }
                     ]
                  },
                  {
                     "type": "macro",
                     "uid": "00001.00019",
                     "tag": "ifid",
                     "inlineText": "ABCDE12345"
                  },
                  {
                     "type": "macro",
                     "uid": "00001.00020",
                     "tag": "subtitle",
                     "body": [
                        {
                           "type": "text",
                           "uid": "00021",
                           "tag": "text",
                           "body": "A short, selection-based mystery game demo."
                        }
                     ]
                  },
                  {
                     "type": "macro",
                     "uid": "00001.00022",
                     "tag": "summary",
                     "body": [
                        {
                           "type": "text",
                           "uid": "00023",
                           "tag": "text",
                           "body": "This is a short demo of the commands available in the TaleSpinner language.&ensp;It is a work in progress."
                        }
                     ]
                  },
                  {
                     "type": "macro",
                     "uid": "00001.00024",
                     "tag": "copyright",
                     "body": [
                        {
                           "type": "text",
                           "uid": "00025",
                           "tag": "text",
                           "body": "(c) 2025 Pete Gardner"
                        }
                     ]
                  }
               ]
            }
         ]
      },
      "stately library": {
         "type": "location",
         "uid": "00002",
         "tag": "location",
         "id": "stately library",
         "displayName": "Stately Library",
         "states": {
            "visited": false,
            "entries": 0
         },
         "body": [
            {
               "type": "macro",
               "uid": "00002.00028",
               "tag": "once",
               "cmdState": {
                  "count": 0
               },
               "body": [
                  {
                     "type": "text",
                     "uid": "00030",
                     "tag": "text",
                     "body": "Welcome to the Demo Adventure, where we test out many of TaleSpinner's features.&ensp;This is a short, selection-based mystery game demo.&ensp;It is a work in progress.\n\n"
                  }
               ]
            },
            {
               "type": "text",
               "uid": "00031",
               "tag": "newline",
               "body": "\n\n"
            },
            {
               "type": "text",
               "uid": "00032",
               "tag": "text",
               "body": "You are in a stately library.&ensp;It is a large room with a high ceiling and many bookshelves.&ensp;There is a "
            },
            {
               "type": "scenerylink",
               "uid": "00033",
               "tag": "scenerylink",
               "id": "large fireplace"
            },
            {
               "type": "text",
               "uid": "00034",
               "tag": "text",
               "body": " on the far wall, and a "
            },
            {
               "type": "scenerylink",
               "uid": "00035",
               "tag": "scenerylink",
               "id": "comfortable-looking chair"
            },
            {
               "type": "text",
               "uid": "00036",
               "tag": "text",
               "body": " in front of it."
            },
            {
               "type": "text",
               "uid": "00037",
               "tag": "text",
               "body": "There is a picture window on the wall to your left, letting in a soft light that illuminates the room.&ensp;On the wall to your right, there is a sturdy "
            },
            {
               "type": "itemlink",
               "uid": "00038",
               "tag": "itemlink",
               "id": "wooden door",
               "inlineText": ""
            },
            {
               "type": "text",
               "uid": "00039",
               "tag": "text",
               "body": ".&ensp;"
            },
            {
               "type": "macro",
               "uid": "00002.00040",
               "tag": "if",
               "leadin": [
                  {
                     "type": "text",
                     "uid": "00041",
                     "tag": "text",
                     "body": "It is presently closed."
                  }
               ],
               "flowController": "true",
               "cond": [
                  {
                     "lval": "wooden door",
                     "op": "is",
                     "rval": "closed"
                  }
               ],
               "body": [
                  {
                     "type": "macro",
                     "uid": "00002.00042",
                     "tag": "else",
                     "body": [
                        {
                           "type": "text",
                           "uid": "00043",
                           "tag": "text",
                           "body": "It is presently open and leads to "
                        },
                        {
                           "type": "hotlink",
                           "uid": "00044",
                           "tag": "hotlink",
                           "id": "study",
                           "inlineText": "the study"
                        },
                        {
                           "type": "text",
                           "uid": "00045",
                           "tag": "text",
                           "body": "."
                        }
                     ]
                  }
               ]
            },
            {
               "type": "text",
               "uid": "00046",
               "tag": "newline",
               "body": "\n\n"
            },
            {
               "type": "text",
               "uid": "00047",
               "tag": "text",
               "body": "A "
            },
            {
               "type": "npclink",
               "uid": "00048",
               "tag": "npclink",
               "id": "venerable sage"
            },
            {
               "type": "text",
               "uid": "00049",
               "tag": "text",
               "body": " is over there sitting in the corner of the room, reading a book."
            },
            {
               "type": "text",
               "uid": "00050",
               "tag": "text",
               "body": "An "
            },
            {
               "type": "hotlink",
               "uid": "00051",
               "tag": "hotlink",
               "id": "foyer",
               "inlineText": "arched doorway"
            },
            {
               "type": "text",
               "uid": "00052",
               "tag": "text",
               "body": " leads to the foyer.&ensp;There is a "
            },
            {
               "type": "macro",
               "uid": "00002.00053",
               "tag": "link",
               "inlineText": "big presentation link here",
               "body": [
                  {
                     "type": "macro",
                     "uid": "00002.00053.00054",
                     "tag": "present",
                     "body": [
                        {
                           "type": "text",
                           "uid": "00055",
                           "tag": "text",
                           "body": "LINK!"
                        }
                     ]
                  }
               ]
            },
            {
               "type": "text",
               "uid": "00056",
               "tag": "text",
               "body": ".&ensp;There is also a "
            },
            {
               "type": "macro",
               "uid": "00002.00057",
               "tag": "link",
               "inlineText": "link that will rerender the location",
               "body": [
                  {
                     "type": "statement",
                     "uid": "00002.00057.00058",
                     "tag": "look"
                  }
               ]
            },
            {
               "type": "text",
               "uid": "00059",
               "tag": "newline",
               "body": "\n\n"
            },
            {
               "type": "statement",
               "uid": "00002.00060",
               "tag": "visibleitems"
            },
            {
               "type": "text",
               "uid": "00061",
               "tag": "text",
               "body": ""
            },
            {
               "type": "statement",
               "uid": "00002.00062",
               "tag": "inventory",
               "inlineText": "You are carrying",
               "settings": {
                  "liststyle": "asyndectic"
               }
            },
            {
               "type": "text",
               "uid": "00063",
               "tag": "newline",
               "body": "\n\n"
            },
            {
               "type": "macro",
               "uid": "00002.00064",
               "tag": "scenery",
               "body": [
                  {
                     "type": "macro",
                     "uid": "00002.00065",
                     "tag": "prop",
                     "id": "large fireplace",
                     "body": [
                        {
                           "type": "text",
                           "uid": "00066",
                           "tag": "text",
                           "body": "You see a large fireplace.&ensp;It is currently unlit."
                        }
                     ]
                  },
                  {
                     "type": "macro",
                     "uid": "00002.00067",
                     "tag": "prop",
                     "id": "comfortable-looking chair",
                     "body": [
                        {
                           "type": "text",
                           "uid": "00068",
                           "tag": "text",
                           "body": "You see a comfortable-looking chair.&ensp;It beckons you.\n"
                        }
                     ]
                  }
               ]
            }
         ]
      },
      "wooden door": {
         "type": "fixed",
         "uid": "00003",
         "tag": "fixed",
         "id": "wooden door",
         "displayName": "wooden door",
         "attrs": {
            "location": "stately library"
         },
         "flags": {
            "closed": false,
            "locked": false
         },
         "states": {
            "encountered": false
         },
         "body": [
            {
               "type": "macro",
               "uid": "00003.00070",
               "tag": "description",
               "body": [
                  {
                     "type": "text",
                     "uid": "00072",
                     "tag": "text",
                     "body": "A sturdy wooden door, fixed firmly into the wall.&ensp;"
                  },
                  {
                     "type": "macro",
                     "uid": "00003.00070.00073",
                     "tag": "if",
                     "leadin": [
                        {
                           "type": "text",
                           "uid": "00074",
                           "tag": "text",
                           "body": "It is presently closed."
                        }
                     ],
                     "flowController": "true",
                     "cond": [
                        {
                           "lval": "wooden door",
                           "op": "is",
                           "rval": "closed"
                        }
                     ],
                     "body": [
                        {
                           "type": "macro",
                           "uid": "00003.00070.00075",
                           "tag": "elseif",
                           "cond": [
                              {
                                 "lval": "wooden door",
                                 "op": "is",
                                 "rval": "locked"
                              }
                           ],
                           "body": [
                              {
                                 "type": "text",
                                 "uid": "00076",
                                 "tag": "text",
                                 "body": "It is currently locked."
                              }
                           ]
                        },
                        {
                           "type": "macro",
                           "uid": "00003.00070.00077",
                           "tag": "else",
                           "body": [
                              {
                                 "type": "text",
                                 "uid": "00078",
                                 "tag": "text",
                                 "body": "It is currently unlocked and open."
                              }
                           ]
                        }
                     ]
                  }
               ]
            },
            {
               "type": "text",
               "uid": "00080",
               "tag": "newline",
               "body": ""
            },
            {
               "type": "macro",
               "uid": "00003.00081",
               "tag": "actions",
               "body": [
                  {
                     "type": "macro",
                     "uid": "00003.00082",
                     "tag": "action",
                     "inlineText": "Open it",
                     "cond": [
                        {
                           "lval": "wooden door",
                           "op": "is",
                           "rval": "closed"
                        }
                     ],
                     "body": [
                        {
                           "type": "macro",
                           "uid": "00003.00083",
                           "tag": "if",
                           "leadin": [
                              {
                                 "type": "macro",
                                 "uid": "00003.00084",
                                 "tag": "present",
                                 "body": [
                                    {
                                       "type": "text",
                                       "uid": "00086",
                                       "tag": "text",
                                       "body": "The door is locked.&ensp;I need a key.\n\t\t\t"
                                    }
                                 ]
                              },
                              {
                                 "type": "text",
                                 "uid": "00087",
                                 "tag": "newline",
                                 "body": "\n"
                              }
                           ],
                           "flowController": "true",
                           "cond": [
                              {
                                 "lval": "wooden door",
                                 "op": "is",
                                 "rval": "locked"
                              }
                           ],
                           "body": [
                              {
                                 "type": "macro",
                                 "uid": "00003.00088",
                                 "tag": "elseif",
                                 "cond": [
                                    {
                                       "lval": "wooden door",
                                       "op": "is",
                                       "rval": "closed"
                                    }
                                 ],
                                 "body": [
                                    {
                                       "type": "macro",
                                       "uid": "00003.00089",
                                       "tag": "present",
                                       "body": [
                                          {
                                             "type": "text",
                                             "uid": "00091",
                                             "tag": "text",
                                             "body": "The door is now open.\n\t\t\t\t"
                                          },
                                          {
                                             "type": "assignment",
                                             "uid": "00003.00089.00092",
                                             "tag": "set",
                                             "id": "wooden door",
                                             "op": "to not",
                                             "rval": "closed"
                                          }
                                       ]
                                    }
                                 ]
                              },
                              {
                                 "type": "macro",
                                 "uid": "00003.00095",
                                 "tag": "else",
                                 "body": [
                                    {
                                       "type": "macro",
                                       "uid": "00003.00096",
                                       "tag": "present",
                                       "body": [
                                          {
                                             "type": "text",
                                             "uid": "00098",
                                             "tag": "text",
                                             "body": "The door is already open.\n\t\t\t"
                                          }
                                       ]
                                    }
                                 ]
                              }
                           ]
                        }
                     ]
                  },
                  {
                     "type": "macro",
                     "uid": "00003.00101",
                     "tag": "action",
                     "inlineText": "Unlock it",
                     "cond": [
                        {
                           "lval": "wooden door",
                           "op": "is",
                           "rval": "locked"
                        }
                     ],
                     "body": [
                        {
                           "type": "macro",
                           "uid": "00003.00102",
                           "tag": "if",
                           "leadin": [
                              {
                                 "type": "macro",
                                 "uid": "00003.00103",
                                 "tag": "present",
                                 "body": [
                                    {
                                       "type": "text",
                                       "uid": "00105",
                                       "tag": "text",
                                       "body": "You unlock the door with the rusty key.\n\t\t\t"
                                    }
                                 ]
                              },
                              {
                                 "type": "assignment",
                                 "uid": "00003.00107",
                                 "tag": "set",
                                 "id": "wooden door",
                                 "op": "to not",
                                 "rval": "locked"
                              },
                              {
                                 "type": "text",
                                 "uid": "00108",
                                 "tag": "newline",
                                 "body": "\n"
                              }
                           ],
                           "flowController": "true",
                           "cond": [
                              {
                                 "lval": "rusty key",
                                 "op": "is",
                                 "rval": "carried"
                              }
                           ],
                           "body": [
                              {
                                 "type": "macro",
                                 "uid": "00003.00109",
                                 "tag": "else",
                                 "body": [
                                    {
                                       "type": "macro",
                                       "uid": "00003.00110",
                                       "tag": "present",
                                       "body": [
                                          {
                                             "type": "text",
                                             "uid": "00112",
                                             "tag": "text",
                                             "body": "I need a key to unlock this door.\n\t\t\t"
                                          }
                                       ]
                                    }
                                 ]
                              }
                           ]
                        }
                     ]
                  }
               ]
            }
         ]
      },
      "foyer": {
         "type": "location",
         "uid": "00004",
         "tag": "location",
         "id": "foyer",
         "displayName": "Foyer",
         "states": {
            "visited": false,
            "entries": 0
         },
         "body": [
            {
               "type": "text",
               "uid": "00117",
               "tag": "text",
               "body": "You are in the foyer.&ensp;It is a small room with a high ceiling and a large chandelier.&ensp;There is a large staircase leading up to the second floor.&ensp;There is an "
            },
            {
               "type": "hotlink",
               "uid": "00118",
               "tag": "hotlink",
               "id": "stately library",
               "inlineText": "arched doorway"
            },
            {
               "type": "text",
               "uid": "00119",
               "tag": "text",
               "body": " leading to the library, a "
            },
            {
               "type": "hotlink",
               "uid": "00120",
               "tag": "hotlink",
               "id": "study",
               "inlineText": "sturdy wooden doorway"
            },
            {
               "type": "text",
               "uid": "00121",
               "tag": "text",
               "body": " leading to the study, and a long corridor leading to the back of the house.\n\n"
            },
            {
               "type": "statement",
               "uid": "00004.00122",
               "tag": "visibleitems"
            },
            {
               "type": "text",
               "uid": "00123",
               "tag": "text",
               "body": ""
            },
            {
               "type": "statement",
               "uid": "00004.00124",
               "tag": "inventory",
               "inlineText": "You are carrying",
               "settings": {
                  "liststyle": "asyndectic"
               }
            },
            {
               "type": "text",
               "uid": "00125",
               "tag": "newline",
               "body": "\n\n"
            },
            {
               "type": "macro",
               "uid": "00004.00126",
               "tag": "chain",
               "cmdState": {
                  "count": 0
               },
               "body": [
                  {
                     "type": "macro",
                     "uid": "00004.00127",
                     "tag": "clink",
                     "body": [
                        {
                           "type": "text",
                           "uid": "00128",
                           "tag": "text",
                           "body": "You hear a clinking sound, like metal on metal.&ensp;It seems to be coming from the direction of the staircase."
                        }
                     ]
                  },
                  {
                     "type": "macro",
                     "uid": "00004.00129",
                     "tag": "clink",
                     "inlineText": "It's getting louder",
                     "body": [
                        {
                           "type": "text",
                           "uid": "00130",
                           "tag": "text",
                           "body": "It's getting louder.&ensp;It sounds like something is being dragged up the stairs."
                        }
                     ]
                  },
                  {
                     "type": "macro",
                     "uid": "00004.00131",
                     "tag": "clink",
                     "inlineText": "What's that?",
                     "body": [
                        {
                           "type": "text",
                           "uid": "00132",
                           "tag": "text",
                           "body": "You see a shadow at the top of the stairs.&ensp;It looks like someone is dragging something heavy up the stairs."
                        }
                     ]
                  },
                  {
                     "type": "macro",
                     "uid": "00004.00133",
                     "tag": "clink",
                     "inlineText": "Where did it go?",
                     "body": [
                        {
                           "type": "text",
                           "uid": "00134",
                           "tag": "text",
                           "body": "The shadow disappears, and the clinking sound stops.\n"
                        }
                     ]
                  }
               ]
            }
         ]
      },
      "study": {
         "type": "location",
         "uid": "00005",
         "tag": "location",
         "id": "study",
         "displayName": "Study",
         "states": {
            "visited": false,
            "entries": 0
         },
         "body": [
            {
               "type": "text",
               "uid": "00137",
               "tag": "text",
               "body": "You are in an unused study.&ensp;It is a small room with a high ceiling and a large desk.&ensp;There is a large window on the wall to your left, letting in a soft light that illuminates the room.&ensp;On the wall to your right, there is a "
            },
            {
               "type": "hotlink",
               "uid": "00138",
               "tag": "hotlink",
               "id": "foyer",
               "inlineText": "sturdy wooden doorway"
            },
            {
               "type": "text",
               "uid": "00139",
               "tag": "text",
               "body": " leading to the foyer."
            },
            {
               "type": "text",
               "uid": "00140",
               "tag": "text",
               "body": "There's a shimmering mirror standing in the corner that you might be able to "
            },
            {
               "type": "macro",
               "uid": "00005.00141",
               "tag": "link",
               "inlineText": "walk through",
               "body": [
                  {
                     "type": "statement",
                     "uid": "00005.00141.00142",
                     "tag": "goto",
                     "id": "stately library"
                  }
               ]
            },
            {
               "type": "text",
               "uid": "00143",
               "tag": "text",
               "body": ".\n\n"
            },
            {
               "type": "statement",
               "uid": "00005.00144",
               "tag": "visibleitems"
            },
            {
               "type": "text",
               "uid": "00145",
               "tag": "text",
               "body": ""
            },
            {
               "type": "statement",
               "uid": "00005.00146",
               "tag": "inventory",
               "inlineText": "You are carrying",
               "settings": {
                  "liststyle": "asyndectic"
               }
            },
            {
               "type": "text",
               "uid": "00147",
               "tag": "newline",
               "body": "\n\n"
            },
            {
               "type": "macro",
               "uid": "00005.00148",
               "tag": "each",
               "cmdState": {
                  "count": 0
               },
               "body": [
                  {
                     "type": "macro",
                     "uid": "00005.00149",
                     "tag": "step",
                     "body": [
                        {
                           "type": "text",
                           "uid": "00150",
                           "tag": "text",
                           "body": "You have entered the Study for the very first time!"
                        }
                     ]
                  },
                  {
                     "type": "macro",
                     "uid": "00005.00151",
                     "tag": "step",
                     "body": [
                        {
                           "type": "text",
                           "uid": "00152",
                           "tag": "text",
                           "body": "This is your second time in the Study."
                        }
                     ]
                  },
                  {
                     "type": "macro",
                     "uid": "00005.00153",
                     "tag": "step",
                     "body": [
                        {
                           "type": "text",
                           "uid": "00154",
                           "tag": "text",
                           "body": "This is your third time in the Study.&ensp;No more updates after this.\n"
                        }
                     ]
                  }
               ]
            },
            {
               "type": "text",
               "uid": "00155",
               "tag": "newline",
               "body": "\n\n"
            },
            {
               "type": "macro",
               "uid": "00005.00156",
               "tag": "exiting",
               "cond": [
                  {
                     "lval": "monacle",
                     "op": "is",
                     "rval": "carried"
                  }
               ],
               "body": [
                  {
                     "type": "text",
                     "uid": "00158",
                     "tag": "text",
                     "body": "As you exit, the monacle glows briefly, and you feel a strange sensation.\n"
                  }
               ]
            }
         ]
      },
      "mystery room": {
         "type": "location",
         "uid": "00006",
         "tag": "location",
         "id": "mystery room",
         "displayName": "Mystery Room",
         "states": {
            "visited": false,
            "entries": 0
         },
         "body": [
            {
               "type": "text",
               "uid": "00161",
               "tag": "text",
               "body": "You are in a mysterious room.&ensp;It is a small room with a high ceiling and a large desk.&ensp;There is a large window on the wall to your left, letting in a soft light that illuminates the room."
            }
         ]
      },
      "letter": {
         "type": "item",
         "uid": "00007",
         "tag": "item",
         "id": "letter",
         "displayName": "letter",
         "attrs": {
            "location": "player"
         },
         "flags": {
            "read": false
         },
         "states": {
            "handled": false,
            "encountered": false,
            "position": "player"
         },
         "body": [
            {
               "type": "macro",
               "uid": "00007.00162",
               "tag": "description",
               "body": [
                  {
                     "type": "text",
                     "uid": "00164",
                     "tag": "text",
                     "body": "An envelope with a "
                  },
                  {
                     "type": "itemlink",
                     "uid": "00165",
                     "tag": "itemlink",
                     "id": "letter",
                     "inlineText": ""
                  },
                  {
                     "type": "text",
                     "uid": "00166",
                     "tag": "text",
                     "body": " inside.&ensp;It is addressed to you.&ensp;What could it say?\n"
                  }
               ]
            },
            {
               "type": "text",
               "uid": "00167",
               "tag": "newline",
               "body": ""
            },
            {
               "type": "macro",
               "uid": "00007.00168",
               "tag": "actions",
               "body": [
                  {
                     "type": "macro",
                     "uid": "00007.00169",
                     "tag": "action",
                     "inlineText": "Read letter",
                     "cond": [
                        {
                           "lval": "letter",
                           "op": "is",
                           "rval": "carried"
                        }
                     ],
                     "body": [
                        {
                           "type": "macro",
                           "uid": "00007.00170",
                           "tag": "present",
                           "cond": [
                              {
                                 "lval": "letter",
                                 "op": "is",
                                 "rval": "read"
                              }
                           ],
                           "body": [
                              {
                                 "type": "text",
                                 "uid": "00172",
                                 "tag": "text",
                                 "body": "James: Don't dilly-dally."
                              },
                              {
                                 "type": "text",
                                 "uid": "00173",
                                 "tag": "text",
                                 "body": "Signed, M.&ensp;"
                              },
                              {
                                 "type": "text",
                                 "uid": "00174",
                                 "tag": "text",
                                 "body": "P.S.&ensp;Q says get on with it!\n\t\t"
                              }
                           ]
                        },
                        {
                           "type": "macro",
                           "uid": "00007.00176",
                           "tag": "present",
                           "cond": [
                              {
                                 "lval": "letter",
                                 "op": "is not",
                                 "rval": "read"
                              }
                           ],
                           "body": [
                              {
                                 "type": "text",
                                 "uid": "00178",
                                 "tag": "text",
                                 "body": "James: We must get the plans back by tonight!&ensp;We believe they're hidden within this Fun House.&ensp;Signed, M.&ensp;"
                              },
                              {
                                 "type": "text",
                                 "uid": "00179",
                                 "tag": "text",
                                 "body": "P.S.&ensp;Q says enjoy the gum!\n\t\t\t"
                              },
                              {
                                 "type": "assignment",
                                 "uid": "00007.00176.00180",
                                 "tag": "set",
                                 "id": "letter",
                                 "op": "to",
                                 "rval": "read"
                              }
                           ]
                        }
                     ]
                  }
               ]
            }
         ]
      },
      "rusty key": {
         "type": "item",
         "uid": "00008",
         "tag": "item",
         "id": "rusty key",
         "displayName": "rusty key",
         "attrs": {
            "location": "foyer"
         },
         "flags": {},
         "states": {
            "handled": false,
            "encountered": false,
            "position": "foyer"
         },
         "body": [
            {
               "type": "macro",
               "uid": "00008.00184",
               "tag": "initial",
               "body": [
                  {
                     "type": "text",
                     "uid": "00186",
                     "tag": "text",
                     "body": "A "
                  },
                  {
                     "type": "itemlink",
                     "uid": "00187",
                     "tag": "itemlink",
                     "id": "rusty key",
                     "inlineText": ""
                  },
                  {
                     "type": "text",
                     "uid": "00188",
                     "tag": "text",
                     "body": " lies on the ground, discarded."
                  }
               ]
            },
            {
               "type": "macro",
               "uid": "00008.00190",
               "tag": "description",
               "body": [
                  {
                     "type": "text",
                     "uid": "00192",
                     "tag": "text",
                     "body": "It is a rusty key, probably for an old lock.&ensp;It looks like it has been here for a long time.\n"
                  }
               ]
            }
         ]
      },
      "monacle": {
         "type": "item",
         "uid": "00009",
         "tag": "item",
         "id": "monacle",
         "displayName": "monacle",
         "attrs": {
            "location": "stately library"
         },
         "flags": {},
         "states": {
            "handled": false,
            "encountered": false,
            "position": "stately library"
         },
         "body": [
            {
               "type": "macro",
               "uid": "00009.00194",
               "tag": "initial",
               "body": [
                  {
                     "type": "text",
                     "uid": "00196",
                     "tag": "text",
                     "body": "A "
                  },
                  {
                     "type": "itemlink",
                     "uid": "00197",
                     "tag": "itemlink",
                     "id": "monacle",
                     "inlineText": ""
                  },
                  {
                     "type": "text",
                     "uid": "00198",
                     "tag": "text",
                     "body": " lies on the ground, glinting."
                  }
               ]
            },
            {
               "type": "macro",
               "uid": "00009.00200",
               "tag": "description",
               "body": [
                  {
                     "type": "text",
                     "uid": "00202",
                     "tag": "text",
                     "body": "It is a monacle, a single eyeglass.&ensp;It is made of brass and has a leather strap.\n"
                  }
               ]
            }
         ]
      },
      "umbrella": {
         "type": "item",
         "uid": "00010",
         "tag": "item",
         "id": "umbrella",
         "displayName": "umbrella",
         "attrs": {
            "location": "stately library"
         },
         "flags": {
            "open": false,
            "engaged": false
         },
         "states": {
            "handled": false,
            "encountered": false,
            "position": "stately library"
         },
         "body": [
            {
               "type": "macro",
               "uid": "00010.00204",
               "tag": "initial",
               "body": [
                  {
                     "type": "text",
                     "uid": "00206",
                     "tag": "text",
                     "body": "A large "
                  },
                  {
                     "type": "itemlink",
                     "uid": "00207",
                     "tag": "itemlink",
                     "id": "umbrella",
                     "inlineText": ""
                  },
                  {
                     "type": "text",
                     "uid": "00208",
                     "tag": "text",
                     "body": " lies in the corner, discarded.&ensp;Next to a "
                  },
                  {
                     "type": "itemlink",
                     "uid": "00209",
                     "tag": "itemlink",
                     "id": "monacle",
                     "inlineText": ""
                  },
                  {
                     "type": "text",
                     "uid": "00210",
                     "tag": "text",
                     "body": "."
                  }
               ]
            },
            {
               "type": "macro",
               "uid": "00010.00212",
               "tag": "description",
               "body": [
                  {
                     "type": "text",
                     "uid": "00214",
                     "tag": "text",
                     "body": "It is a large umbrella, made of black fabric.&ensp;It has a wooden handle and a brass tip.&ensp;It is currently open, as if it had been used recently.\n"
                  }
               ]
            },
            {
               "type": "text",
               "uid": "00215",
               "tag": "newline",
               "body": ""
            },
            {
               "type": "macro",
               "uid": "00010.00216",
               "tag": "actions",
               "body": [
                  {
                     "type": "macro",
                     "uid": "00010.00217",
                     "tag": "action",
                     "inlineText": "Close umbrella",
                     "cond": [
                        {
                           "lval": "umbrella",
                           "op": "is",
                           "rval": "open"
                        }
                     ],
                     "body": [
                        {
                           "type": "macro",
                           "uid": "00010.00218",
                           "tag": "present",
                           "body": [
                              {
                                 "type": "text",
                                 "uid": "00220",
                                 "tag": "text",
                                 "body": "The umbrella is now closed.\n\t\t\t"
                              },
                              {
                                 "type": "assignment",
                                 "uid": "00010.00218.00221",
                                 "tag": "set",
                                 "id": "umbrella",
                                 "op": "to not",
                                 "rval": "open"
                              }
                           ]
                        }
                     ]
                  },
                  {
                     "type": "macro",
                     "uid": "00010.00224",
                     "tag": "action",
                     "inlineText": "Open umbrella",
                     "cond": [
                        {
                           "lval": "umbrella",
                           "op": "is not",
                           "rval": "open"
                        }
                     ],
                     "body": [
                        {
                           "type": "macro",
                           "uid": "00010.00225",
                           "tag": "present",
                           "body": [
                              {
                                 "type": "text",
                                 "uid": "00227",
                                 "tag": "text",
                                 "body": "The umbrella is now open.\n\t\t\t"
                              },
                              {
                                 "type": "assignment",
                                 "uid": "00010.00225.00228",
                                 "tag": "set",
                                 "id": "umbrella",
                                 "op": "to",
                                 "rval": "open"
                              }
                           ]
                        }
                     ]
                  }
               ]
            }
         ]
      },
      "venerable sage": {
         "type": "npc",
         "uid": "00011",
         "tag": "npc",
         "id": "venerable sage",
         "displayName": "venerable sage",
         "attrs": {
            "location": "stately library"
         },
         "flags": {
            "engaged": false
         },
         "states": {
            "met": false,
            "encountered": false,
            "position": "stately library"
         },
         "body": [
            {
               "type": "macro",
               "uid": "00011.00232",
               "tag": "initial",
               "body": [
                  {
                     "type": "text",
                     "uid": "00234",
                     "tag": "text",
                     "body": "A "
                  },
                  {
                     "type": "npclink",
                     "uid": "00235",
                     "tag": "npclink",
                     "id": "venerable sage"
                  },
                  {
                     "type": "text",
                     "uid": "00236",
                     "tag": "text",
                     "body": " is sitting in the corner of the room, reading a book."
                  }
               ]
            },
            {
               "type": "macro",
               "uid": "00011.00238",
               "tag": "description",
               "body": [
                  {
                     "type": "text",
                     "uid": "00240",
                     "tag": "text",
                     "body": "You see a venerable sage sitting in the corner of the room, reading a book.&ensp;He is an old man with a long white beard and wise, thoughtful eyes.&ensp;His presence adds an air of mystery and knowledge to the library.\n"
                  }
               ]
            }
         ]
      }
   },
   "snippets": {
      "player": {
         "id": "player",
         "uid": "$_uid_",
         "type": "npc",
         "attrs": {
            "pronoun": "proper",
            "location": "$_startloc_"
         },
         "states": {
            "position": "$_startloc_",
            "encountered": true,
            "met": true
         }
      },
      "offstage": {
         "id": "offstage",
         "uid": "$_uid_",
         "type": "location",
         "tag": "location",
         "displayName": "Offstage",
         "states": {
            "visited": false,
            "entries": 0
         },
         "body": [
            {
               "type": "text",
               "uid": "$_uid_",
               "tag": "text",
               "body": "You should not be here."
            }
         ]
      },
      "item_actions": {
         "type": "macro",
         "uid": "$_uid_",
         "tag": "actions",
         "body": [
            {
               "type": "macro",
               "uid": "$_uid_",
               "tag": "action",
               "inlineText": "Take it",
               "cond": [
                  {
                     "lval": "$_entityid_",
                     "op": "is not",
                     "rval": "carried"
                  }
               ],
               "body": [
                  {
                     "type": "assignment",
                     "uid": "$_uid_",
                     "tag": "takeitem",
                     "id": "$_entityid_"
                  }
               ]
            },
            {
               "type": "macro",
               "uid": "$_uid_",
               "tag": "action",
               "inlineText": "Drop it",
               "cond": [
                  {
                     "lval": "$_entityid_",
                     "op": "is",
                     "rval": "carried"
                  }
               ],
               "body": [
                  {
                     "type": "assignment",
                     "uid": "$_uid_",
                     "tag": "dropitem",
                     "id": "$_entityid_"
                  }
               ]
            }
         ]
      }
   },
   "commands": [
      "actions",
      "break",
      "call",
      "chain",
      "clearEvent",
      "description",
      "dismiss",
      "dropitem",
      "each",
      "entityRef",
      "exiting",
      "gate",
      "goto",
      "hide",
      "hotlink",
      "i",
      "if",
      "initial",
      "interact",
      "interface",
      "inventory",
      "itemlink",
      "itemselect",
      "itemui",
      "link",
      "look",
      "move",
      "newline",
      "npclink",
      "once",
      "play",
      "present",
      "presentitemselect",
      "resume",
      "scenery",
      "scenerylink",
      "set",
      "settings",
      "stop",
      "takeitem",
      "talk",
      "text",
      "topics",
      "tostring",
      "triggerEvent",
      "variable",
      "visibleitems",
      "app_version",
      "tsp_version",
      "copyright",
      "greeting",
      "subtitle",
      "default",
      "summary",
      "action",
      "author",
      "choice",
      "elseif",
      "option",
      "clink",
      "intro",
      "start",
      "title",
      "topic",
      "else",
      "hold",
      "ifid",
      "loop",
      "prop",
      "step"
   ]
}